<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>CBS Personal Finance | Join The Team</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
	<script defer src="https://webanalytics.digitaljedi.dk/script.js"
		data-website-id="7fa0927d-5461-4f3d-80f8-365d4a948c18"></script>
</head>

<body class="is-preload">

	<!-- Page Wrapper -->
	<div id="page-wrapper">

		<div id="header-container"></div>
		<script src="assets/js/header-loader.js"></script>

		<!-- Wrapper -->
		<section id="wrapper">
			<header class="join-header" id="page-header">
				<div class="inner">
					<h2 id="header-headline"></h2>
					<p id="header-text"></p>
				</div>
			</header>

			<!-- Content -->
			<section id="two" class="wrapper style1">
				<div class="inner">
					<h2 class="major" id="form-headline"></h2>
					<p id="form-text"></p>
					<section>
						<div id="spinner" class="spinner">
							<div class="circle-loader">
								<div class="checkmark draw"></div>
							</div>
						</div>
						<form method="post" id="emailForm">
							<div class="row gtr-uniform">
								<div class="col-6 col-12-xsmall">
									<label for="name" id="form-name-label"></label>
									<input type="text" name="name" id="name" value="" />
								</div>
								<div class="col-6 col-12-xsmall">
									<label for="email" id="form-email-label"></label>
									<input type="email" name="email" id="email" value="" required />
									<span id="form-email-error" style="color:#ff6b6b;font-size:0.85em;display:none;"></span>
								</div>
								<div class="col-12">
									<label for="study" id="form-study-label"></label>
									<select name="study" id="form-study">
									</select>
								</div>
								<div class="col-12">
									<label for="message" id="form-message-label"></label>
									<textarea name="message" id="message" rows="6"></textarea>
								</div>
								<div class="col-12">
									<ul class="actions">
										<li><input id="form-submit" type="submit" value="Send Message" class="primary" /></li>
										<li><input id="form-reset" class="reset" type="reset" value="Reset" /></li>
									</ul>
								</div>
							</div>
						</form>
					</section>
				</div>
			</section>
		</section>

		<!-- Footer -->
		<div id="footer-container"></div>
		<script type="module" src="assets/js/footer-loader.js"></script>
	</div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.scrollex.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
	</script>

	<script type="module">
		import { getEntries, asHttpsUrl } from "./assets/js/contentfull.js";
		import { hideLoader } from "./assets/js/loader.js";

		const joinTheTeam = await getEntries('joinTheTeam');

		// Eksempel: hent en bestemt entry pÃ¥ ID
		insertHeaderContent(joinTheTeam);
		insertFormContent(joinTheTeam);
		hideLoader();
		
		function insertHeaderContent(joinTheTeam) {
			const header = joinTheTeam.get("6lMctj5aGOm3R9EyflX4Hx")?.fields;

			document.getElementById("header-headline").innerHTML = header?.headline;
			document.getElementById("header-text").innerHTML = header?.text;

			const url = asHttpsUrl(header?.image?.fields?.file?.url);
			document.getElementById("page-header").style.backgroundImage =
				`linear-gradient(to top, rgba(44, 55, 95, 0.8), rgba(44, 55, 95, 0.8)), url("${url}")`;
		}

		function insertFormContent(joinTheTeam) {
			const form = joinTheTeam.get("75jzVxscKZeRKYIR8hxXYR")?.fields;

			// Element references
			document.getElementById("form-headline").innerHTML = form?.headline;
			document.getElementById("form-text").innerHTML = form?.text;
			document.getElementById("form-name-label").innerHTML = form?.nameLabel;
			document.getElementById("form-email-label").innerHTML = form?.emailLabel;
			document.getElementById("form-email-error").innerHTML = form?.emailError;
			document.getElementById("form-study-label").innerHTML = form?.studyLabel;
			document.getElementById("form-message-label").innerHTML = form?.messageLabel;
			document.getElementById("form-submit").setAttribute("value", form?.submit);
			document.getElementById("form-reset").setAttribute("value", form?.reset);
		
			// Populate study options
			form?.studyOptions.forEach(option => {
				document.getElementById("form-study").appendChild(createOptionElement(option));
			});
		}

		function createOptionElement(option) {
			const optionElement = document.createElement("option");
			optionElement.setAttribute("value", option);
			optionElement.innerHTML = option;
			return optionElement;
		}

	</script>

	<script type="text/javascript">
		(function () {
			emailjs.init({
				publicKey: "128Hw6C7r5YL9D6_C",
			});
		})();
	</script>
	<script>
		document.getElementById("emailForm").addEventListener("submit", function (e) {
			e.preventDefault();

			const emailInput = document.getElementById("email");
			const emailError = document.getElementById("form-email-error");
			const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
			if (!emailRegex.test(emailInput.value.trim())) {
				emailError.style.display = "inline";
				emailInput.focus();
				return;
			}
			emailError.style.display = "none";

			document.getElementById("emailForm").style.display = "none"
			document.getElementById("spinner").style.display = "inline-block"

			const name = document.getElementById("name").value;
			const title = document.getElementById("form-study").value;
			const email = document.getElementById("email").value;
			const message = document.getElementById("message").value;

			emailjs.send("service_3k7fiqq", "template_r51m0vt", {
				name: name,
				email: email,
				title: title,
				message: message,
			}).then(
				function () {
					$(".circle-loader").toggleClass("load-complete");
					$(".checkmark").toggle();
				},
				function (error) {
					alert("Noget gik galt: " + JSON.stringify(error));
				}
			);
		});
	</script>
</body>

</html>